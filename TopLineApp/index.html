<!DOCTYPE html>
<html>
	<head>
		<title></title>
		<meta charset="utf-8" />
		<script src="cordova.js"></script>
		<script src="kendo/js/jquery.min.js"></script>
		<script src="kendo/js/kendo.all.min.js"></script>

		<link href="kendo/styles/kendo.common.min.css" rel="stylesheet" />
		<link href="kendo/styles/kendo.default.min.css" rel="stylesheet" />
		<link href="kendo/styles/kendo.mobile.all.min.css" rel="stylesheet" />

		<link href="styles/main.css" rel="stylesheet" />
		
	</head>

	<!DOCTYPE html>
	<html>

		<body>

			<div id="v1" data-role="view" data-layout="mobile-view" data-model="viewModel" data-title="Groups" data-transition="slide">
				<header data-role="header">
					<!--replaced navbar to not have a back button-->
					<div data-role="navbar" style="height: 44px;">
						<a id="refreshButton" class="nav-button" data-align="right" data-bind="click:refreshRoutes" data-role="button">Refresh</a>
						<span data-role="view-title"></span>
					</div>
				</header>
				<ul id="lv1" data-bind="source:groupSource, click: selectGroup" data-role="listview" data-auto-bind="false" data-style="inset" data-template="t1"></ul>
			</div>

			<script type="text/x-kendo-template" id="t1">
				<img src="${Foto}" />
				<span>#:VendedorNome#</span>
			</script>

			<div data-role="view" id="v2" data-layout="mobile-view" data-model="viewModel" data-title="People" data-transition="slide">
				<label id="t">Title</label>
				<label id="n">Name</label>
				<ul id="lv2" data-bind="source:peopleSource" data-role="listview" data-style="inset" data-template="t2"></ul>
			</div>

			<script type="text/x-kendo-template" id="t2">
				<img src="${Foto}" />
				<span>#:VendedorNome#</span>
			</script>

			<!--default mobile settings-->
			<div data-role="layout" data-id="mobile-view">
				<header data-role="header">
					<div data-role="navbar">
						<a class="nav-button" data-align="left" data-role="backbutton">Back</a>
						<span data-role="view-title"></span>
					</div>
				</header>
			</div>

			<script>
	          
				var app;
      
				$(document).ready(function() {
					//Start the mobile application
					app = new kendo.mobile.Application($(document.body), {});
				});
                
				//Url
				var baseUrl = "http://localhost:50000/api";
				
				//schema
				var schemaVendedores = { 
					model: {
						id: "IdVendedor",
						fields: {
							IdVendedor: { editable: false, nullable: false },
							VendedorNome: { editable: false, nullable: false },
							VendedorApelido: { editable: false, nullable: false },
							Fila: { editable: false, nullable: false },
							PosicaoFila: { editable: false, nullable: false },            
							Foto: { editable: false, nullable: false }
						} 
					}
				};
				
				//dataSource
				var dsVendFila = new kendo.data.DataSource({                    
					transport: {						
						read:  {
							url: baseUrl + "/Vendedor/1",							
							type:"GET",
							contentType: "application/json",
							dataType: "json"
						}                 
					},
					batch: true,
					schema: schemaVendedores,                    
					sort: {
						field:
						"PosicaoFila", dir
						: "asc"
					}
				}
				);
			                
				var viewModel = kendo.observable({
					groupSource: dsVendFila,
					selectGroup: function(e) {
						this.set("selectedGroup", e.dataItem);
						this.set("peopleSource", new kendo.data.DataSource({
							data: this.get("selectedGroup").People
						}));
						app.navigate("#v2");
					},
					refreshRoutes: function() {
						dsVendFila.options.transport.read.url = baseUrl + "/Vendedor/1";
						dsVendFila.read();        
					}
				});
                
                
			</script>

		</body>
	</html>

</html>

